---
export const prerender = false;
import { turso } from '../turso';

const { rows: posts } = await turso.execute('select * from posts');
 const options: Intl.DateTimeFormatOptions = {
                weekday: 'long',
                day:'2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Europe/Rome',
              }
function createDate(str:string) {
          const date:Date = new Date(str.split(' ').join('T') + '.000Z');
          return new Intl.DateTimeFormat('it-IT', options).format(date)
        } 
---
<h2 class="text-2xl text-center p-2 font-bold">Posts</h2>
  <div class="max-w-90 m-auto">
    {
      posts.map((post: any) => {
        const createdAt = createDate(post.created_at); 
        const updatedAt = createDate(post.updated_at);

        return (
          <div class="p-2">
            <p>Author: {post.author}</p>
            
            <p class="flex" >
              <span class="min-w-20">Created:</span>
              <span>
              {(createdAt)}
                </span>
            </p>
           { createdAt !== updatedAt &&  <p class="flex">
           <span class="min-w-20">Updated:</span>
              <span>
                {(updatedAt)}
              </span>
            </p>}
            <p class="text-center">Content </p>
            <p>{post.body}</p>
          </div>
            <hr class="max-w-[80vw] m-auto mb-2" />
        );
      })
    }
  </div>