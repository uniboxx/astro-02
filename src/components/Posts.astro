---
export const prerender = false;
import { turso } from '../turso';

const { rows: posts } = await turso.execute('select * from posts');
---
<h2 class="text-2xl text-center p-2 font-bold">Posts</h2>
  <div class="max-w-90 m-auto">
    {
      posts.map((post: any) => {
        const createdAtStr = post.created_at.split(' ').join('T') + '.000Z';
        const createdAt = new Date(createdAtStr);
        const updatedAtStr = post.updated_at.split(' ').join('T') + '.000Z';
        const updatedAt = new Date(updatedAtStr);

        return (
          <div class="p-2">
            <p>Author: {post.author}</p>
            
            <p class="flex" >
              <span class="min-w-20">Created:</span>
              <span>

              {new Intl.DateTimeFormat('it-IT', {
                weekday: 'long',
                day:'2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Europe/Rome',
              }).format(createdAt)}
                </span>
            </p>
           { createdAtStr !== updatedAtStr &&  <p class="flex">
           <span class="min-w-20">Updated:</span>
              <span>
                {new Intl.DateTimeFormat('it-IT', {
                weekday: 'long',
                day:'2-digit',
                month: 'short',
                year: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                timeZone: 'Europe/Rome',
              }).format(updatedAt)}
              </span>
            </p>}
            <p class="text-center">Content </p>
            <p>{post.body}</p>
          </div>
            <hr class="max-w-[80vw] m-auto mb-2" />
        );
      })
    }
  </div>